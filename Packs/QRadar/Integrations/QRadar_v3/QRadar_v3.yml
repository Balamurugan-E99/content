commonfields:
  id: QRadar_v3
  version: -1
name: QRadar_v3
display: QRadar_v3
category: Utilities
description: IBM QRadar SIEM helps security teams accurately detect and prioritize
  threats across the enterprise, and it provides intelligent insights that enable
  teams to respond quickly to reduce the impact of incidents.
configuration:
- display: Server URL
  name: server
  type: 0
  required: true
  additionalinfo: (e.g., https://192.168.0.1)
- display: Username
  name: credentials
  type: 9
  required: true
- display: QRadar API Version
  additionalinfo: (e.g. '12.0'). Minimum API version is 10.1.
  name: api_version
  type: 0
  required: true
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
script:
  commands:
  - name: qradar-offenses-list
    arguments:
    - name: offense_id
      description: The offense ID to retrieve its details. Specify offense_id if you
        want to get details only about certain offense.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter offenses. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--siem-offenses-GET.html'
      isArray: true
    description: Gets offenses from QRadar.
  - name: qradar-offense-update
    arguments:
    - name: offense_id
      required: true
      description: The ID of the offense to update.
    - name: protected
      description: Whether the offense should be protected.
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: follow_up
      description: Whether the offense should be marke for follow up.
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: status
      auto: PREDEFINED
      predefined:
      - OPEN
      - HIDDEN
      - CLOSED
      description: The new status for the offense. When the status of an offense is
        set to CLOSED, a valid closing_reason_id must be provided. To hide an offense,
        use the HIDDEN status. To show a previously hidden offense, use the OPEN status.
    - name: closing_reason_id
      description: The ID of a closing reason. You must provide a valid closing_reason_id
        when you close an offense. For full list of closing reason IDs, use 'qradar-closing-reasons'
        command.
    - name: assigned_to
      description: User to assign the offense to.
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--siem-offenses-offense_id-POST.html'
      isArray: true
    description: Update an offense.
  - name: qradar-closing-reasons
    description: Retrieve a list of offense closing reasons.
    arguments:
    - name: closing_reason_id
      required: false
      description: The closing reason ID to retrieve its details. Specify closing_reason_id
        if you want to get details only about certain closing reason.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter closing reasons. For reference please consult:
        https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--siem-offense_closing_reasons-GET.html'
      isArray: true
  - name: qradar-offense-notes-list
    description: Create a note on an offense.
    arguments:
    - name: offense_id
      required: true
      description: The offense ID to retrieve the notes for.
    - name: note_id
      description: The note ID to retrieve its details. Specify note_id if you want
        to get details only about certain note.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter offense notes. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--siem-offenses-offense_id-notes-GET.html'
      isArray: true
  - name: qradar-offense-note-create
    description: Retrieve a list of notes for an offense.
    arguments:
    - name: offense_id
      required: true
      description: The offense ID to add the note to.
    - name: note_text
      required: true
      description: The note text.
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--siem-offenses-offense_id-notes-POST.html'
      isArray: true
  - name: qradar-rules-list
    description: Retrieves a list of rules.
    arguments:
    - name: rule_id
      required: false
      description: The rule ID to retrieve its details. Specify rule_id if you want
        to get details only about certain rule.
    - name: rule_type
      auto: PREDEFINED
      predefined:
      - EVENT
      - FLOW
      - COMMON
      - USER
      description: Retrieve rules corresponding to the given rule type.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter rules. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi150.doc/15.0--analytics-rules-GET.html'
      isArray: true

  - name: qradar-rule-groups-list
    description: Retrieves a list of the rule groups.
    arguments:
    - name: rule_group_id
      required: false
      description: The rule group ID to retrieve its details. Specify rule_group_id
        if you want to get details only about certain rule group.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter rules. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--analytics-rule_groups-GET.html'
      isArray: true
  - name: qradar-assets-list
    description: Retrieves assets list.
    arguments:
    - name: asset_id
      required: false
      description: The asset ID to retrieve its details. Specify asset_id if you want
        to get details only about certain asset.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter assets. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--asset_model-assets-GET.html'
      isArray: true
  - name: qradar-saved-searches-list
    description: Retrieves a list of Ariel saved searches.
    arguments:
    - name: saved_search_id
      required: false
      description: The saved search ID to retrieve its details. Specify saved_search_id
        if you want to get details only about certain saved search.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter saved searches. For reference please consult:
        https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--ariel-saved_searches-GET.html'
      isArray: true

  - name: qradar-searches-list
    description: Retrieves the list of Ariel searches IDs. Search status and results
      can be polled by sending search ID to 'qradar-search-status-get' and 'qradar-search-results-get'
      commands.
    arguments:
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter saved searches. For reference please consult:
        https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
  - name: qradar-search-create
    description: Create a new asynchronous Ariel search. Returns search ID. Search
      status and results can be polled by sending search ID to 'qradar-search-status-get'
      and 'qradar-search-results-get' commands. Accepts SELECT query expressions only.
    arguments:
    - name: query_expression
      required: false
      description: The AQL query to execute. Mutually exclusive with saved_search_id.
    - name: saved_search_id
      required: false
      description: Saved search ID to execute. Mutually exclusive with query_expression.
        Saved search ID is 'id' field returned by command 'qradar-saved-searches-list'.
  - name: qradar-search-status-get
    description: Retrieve status information for a search, based on the search ID
      parameter.
    arguments:
    - name: search_id
      required: true
      description: The identifier for an Ariel search.
  - name: qradar-search-results-get
    description: Retrieves search results.
    arguments:
    - name: search_id
      required: true
      description: The identifier for an Ariel search.
    - name: range
      description: 'Range of events to return. (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
  - name: qradar-reference-sets-list
    description: Retrieve a list of reference sets.
    arguments:
    - name: ref_name
      required: false
      description: The reference name of the reference set to retrieve its details.
        Specify ref_name if you want to get details only about certain reference set.
    - name: value
      required: false
      description: TODO understand how to use it
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter reference sets. For reference please consult:
        https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--reference_data-sets-GET.html'
      isArray: true
  - name: qradar-reference-set-create
    description: Create a new reference set.
    arguments:
    - name: ref_name
      required: true
      description: The name of the reference set to be created.
    - name: element_type
      auto: PREDEFINED
      required: true
      predefined:
      - ALN
      - ALNIC
      - NUM
      - IP
      - PORT
      - DATE
      description: The element type for the values allowed in the reference set.
    - name: timeout_type
      description: Indicates if the time_to_live interval is based on when the data
        was first seen or last seen.
      auto: PREDEFINED
      defaultValue: UNKNOWN
      required: false
      predefined:
      - FIRST_SEEN
      - LAST_SEEN
      - UNKNOWN
      - IP
      - PORT
      - DATE
    - name: time_to_live
      required: false
      description: "The time to live interval, time range. for example: '1 month'\
        \ or '5 minutes'"
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--reference_data-sets-POST.html'
      isArray: true
  - name: qradar-reference-set-delete
    description: Removes a reference set or purges its contents. TODO see if purge
      or not
    arguments:
    - name: ref_name
      required: true
      description: The name of the reference set to be deleted.
  - name: qradar-reference-set-value-upsert
    description: Add or update an element in a reference set.
    arguments:
    - name: ref_name
      required: true
      description: The name of the reference set to add or update an element in.
    - name: value
      required: true
      description: "The value to add or update in the reference set. If value chosen\
        \ is date, supported date formats are: epoch, ISO, and time range (<number>\
        \ <time unit>', e.g., 12 hours, 7 days.)"
    - name: source
      required: false
      description: An indication of where the data originated.
      defaultValue: reference data api
    - name: date_value
      description: True if the value given type was date.
      auto: PREDEFINED
      required: false
      predefined:
      - 'True'
      - 'False'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--reference_data-sets-name-POST.html'
      isArray: true
  - name: qradar-reference-set-value-delete
    description: Remove a value from a reference set.
    arguments:
    - name: ref_name
      required: true
      description: The name of the reference set to remove a value from.
    - name: value
      required: true
      description: "The value to remove from the reference set. If value chosen is\
        \ date, supported date formats are: epoch, ISO, and time range (<number> <time\
        \ unit>, e.g., 12 hours, 7 days.)"
    - name: date_value
      description: True if the value given type was date.
      auto: PREDEFINED
      required: false
      predefined:
      - 'True'
      - 'False'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--reference_data-sets-name-value-DELETE.html'
      isArray: true
  - name: qradar-domains-list
    description: Gets the list of domains. You must have the System Administrator
      or Security Administrator permissions to call this endpoint if you are trying
      to retrieve the details of all domains. You can retrieve details of domains
      that are assigned to your Security Profile without having the System Administrator
      or Security Administrator permissions. If you do not have the System Administrator
      or Security Administrator permissions, then for each domain assigned to your
      security profile you can only view the values for the id and name fields. All
      other values return null.
    arguments:
    - name: domain_id
      description: The domain ID to retrieve its details. Specify domain_id if you
        want to get details only about certain domain.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter domains. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--config-domain_management-domains-GET.html'
      isArray: true
  - name: qradar-geolocations-for-ip
    description: Retrieves the MaxMind geoip data for the given IP address.
    arguments:
    - name: ips
      description: Comma seperated list of IPs to retrieve their geolocation.
      required: true
      isArray: true
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--services-geolocations-GET.html'
      isArray: true
  - name: qradar-log-sources-list
    description: Retrieves a list of log sources.
    arguments:
    - name: qrd_encryption_algorithm
      description: The algorithm to use for encrypting the sensitive data of this
        endpoint
      auto: PREDEFINED
      required: true
      predefined:
      - AES128
      - AES256
    - name: qrd_encryption_password
      description: The password to use for encrypting the sensitive data of this endpoint.
        Default value is the user's password.
    - name: range
      description: 'Range of results to return (e.g.: 0-20, 3-5, 3-3).'
      defaultValue: 0-49
    - name: filter
      description: 'Query to filter domains. For reference please consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi.doc/c_rest_api_filtering.html'
    - name: fields
      description: 'If used, will filter all fields except for the specified ones.
        Use this parameter to specify which fields you would like to get back in the
        response. Fields that are not explicitly named are excluded. Specify subfields
        in brackets and multiple fields in the same object separated by commas. For
        full list of available fields, consult: https://www.ibm.com/support/knowledgecenter/SS42VS_SHR/com.ibm.qradarapi140.doc/14.0--config-event_sources-log_source_management-log_sources-GET.html'
      isArray: true
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.9.1.15759
fromversion: 5.0.0
tests:
- No tests (auto formatted)
